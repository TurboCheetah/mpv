
###\\ Absinth's MPV config //###
 ##// -------------------- \\##
 
     title= ${media-title} - Nigmode media player
	 osd-status-msg=${playback-time/full} / ${duration} (${percent-pos}%)\nframe: ${estimated-frame-number} / ${estimated-frame-count}
	 
 #/--/ GPU encoding with VULKAN (Fuck OpenGL) \--\#
 
 profile=gpu-hq
 vo=gpu
 gpu-api=vulkan
 fbo-format=rgba16hf
 
 #/--/ Watching expirience \--\#
 #\--\ ------------------- /--/#
 
 #/ Overall Player settings \#                                                                                   
 reset-on-next-file=profile
 image-display-duration=inf
 no-resume-playback
 ordered-chapters
 keep-open=yes
 keep-open                                
 
 #/ Cursor \#
 cursor-autohide-fs-only
 cursor-autohide=1000 
 
 #/ Display settings \#
 force-window-position=yes
 autofit-smaller=720x480
 autofit-larger=50%x50%
 geometry=50%:50%
 keepaspect-window
 keepaspect
 stop-screensaver
 
 #/ Seeking \#
 force-seekable=yes
 hr-seek=absolute
 hr-seek-framedrop=no
 
 #/ Subtitles and Dubbing Preference \#
 slang=english full,en,eng,enUS
 alang=ja,jp,jpn,en,eng
 
 #/ Subs settings \#
 sub-ass-override=no 
 sub-font=Manrope
 sub-font-size=50
 sub-color="#FFFFFF"
 sub-border-size=3.0
 sub-border-color="#FF000000"
 sub-shadow-color="#A0000000"
 sub-shadow-offset=0.75
 sub-ass
 sub-bold
 sub-auto=exact
 embeddedfonts=yes                       
 sub-fix-timing=no                       
 sub-ass-force-style=Kerning=yes         
 sub-gray=yes	# make vobsub/srt black&white if they are yellow&black
 sub-gauss=0.749998 # Ghetto AA for vobsub
 sub-ass-vsfilter-blur-compat=no
 
 #/--/ OSD \--\#
 #\--\ --- /--/#

 osd-font='Source Sans Pro'
 osd-font-size=20
 osd-color='#eeeeee'                        
 osd-blur=5								 # Fancy blur while in stats page :)
 no-osd-bar
 no-border                               
 msg-module                              
 msg-color
 
 #/--/ Screenshots \--\#
 #\--\ ----------- /--/#
 
 zimg-scaler=spline36
 zimg-scaler-chroma=bicubic
 zimg-scaler-chroma-param-a=0
 zimg-scaler-chroma-param-b=0.5
 zimg-dither=error-diffusion
 zimg-fast=no
 screenshot-format=webp
 screenshot-webp-lossless=yes
 screenshot-webp-compression=6
#  screenshot-template="%F_%P_%n"
 screenshot-template="%{media-title}_%{estimated-frame-number}_%n"
 screenshot-directory=~/
 
 #/--/ AUDIO \--\#
 #\--\ ----- /--/#
 
 audio-pitch-correction=yes 
 volume-max=200                          
 volume=40                       

 #/--/ VIDEO \--\#
 #\--\ ----- /--/#
 
 #luma downscaling
 dscale=bcspline
 dscale-param1=-0.5                                                 
 dscale-param2=0.25
 
 #luma upscaling (refer to custom profiles for rest)
 scale=ewa_lanczossharp
 sigmoid-upscaling=no

 #Chroma upscaling and downscaling (refer to custom profiles for rest)
 cscale=ewa_hanning
 cscale-window=blackman
 cscale-radius=3
 
 #debanding (Keybind = D)
 deband=no
 deband-iterations=2
 deband-threshold=64
 deband-range=17
 deband-grain=12
 
 
 #/--/ STREAMING \--\#
 #\--\ --------- /--/#
  
 cache=yes
 cache-pause=yes
 cache-pause-wait=2
 cache-pause-initial=yes
 demuxer-max-bytes=1000000KiB
 stream-buffer-size=100MiB
 hls-bitrate=max
 
 #/--/ Custom Profiles \--\#
 #\--\ --------------- /--/#
 
 [444]
 profile-desc=cond:((p["video-params/pixelformat"] == "yuv444p10"))
 glsl-shader="~~/shaders/KrigBilateral-new-444.glsl"

 [420]
 profile-desc=cond:((p["video-params/pixelformat"] == "yuv420p12" or p["video-params/pixelformat"] == "yuv420p10" or p["video-params/pixelformat"] == "yuv420p"))
 glsl-shader="~~/shaders/KrigBilateral-new.glsl"

 [FullHD]
 profile-desc=cond:((p["video-params/h"] >= 900))
 glsl-shaders="~~/shaders/nnedi3-nns256-win8x6.hook"

 [HD]
 profile-desc=cond:((p["video-params/h"] >= 700 and p["video-params/h"] < 900))
 glsl-shaders="~~/shaders/nnedi3-nns256-win8x6.hook"

 [SD]
 profile-desc=cond:((p["video-params/w"] <= 1279 or p["video-params/h"] <= 699))
 glsl-shaders-append="~~/shaders/FSRCNNX_x2_16-0-4-1.glsl"
  

 # Deinterlacing
 [VIVTC + znedi3]
 profile-desc="Deinterlacing mode: VIVTC + nnedi3"
 vf-append=@deinterlace:vapoursynth="~~/vpy/deinterlace.vpy":buffered-frames=5:concurrent-frames=5

 [Deinterlace-no]
 profile-desc="Deinterlacing mode: disabled"
 vf-remove=@deinterlace
 deinterlace=no

  # Generic clean-up for simulcasts
 [simulcast]
 vf-append=@simulcast:vapoursynth="~~/vpy/simulcast.vpy":buffered-frames=3:concurrent-frames=4
 profile-desc="Simulcast mode: enabled"
 deband=yes
 glsl-shaders-append=~~/shaders/noise_static_luma.hook
 sub-ass-override=force
 sub-fix-timing=yes

 [simulcast-no]
 vf-remove=@simulcast
 profile-desc="Simulcase mode: disabled"
 deband=no
 glsl-shaders-remove=~~/shaders/noise_static_luma.hook
 sub-ass-override=no
 sub-fix-timing=no

 [simulcast-autoprofile]
 profile-cond=string.match(p.filename, "HorribleSubs")~=nil or string.match(p.filename, "Erai%-raws")~=nil or string.match(p.filename, "SubsPlease")~=nil
 profile=simulcast

 [nonsimulcast-autoprofile]
 profile-cond=string.match(p.filename, "HorribleSubs")==nil and string.match(p.filename, "Erai%-raws")==nil and string.match(p.filename, "SubsPlease")==nil
 profile=simulcast-no
